jQuery(function(){$('input[type="text"].first').focus();$("#tabs").tabs();$("#datepicker").datepicker();$("#datepicker2").datepicker();$("#datepicker3").datepicker();$("#datepicker4").datepicker();$("#datepicker5").datepicker();$("#datepicker6").datepicker();$(".datepicker").datepicker();});function outra_clinica(){$("#seleciona_clinica").show();}function conta_caracteres(){if($("#nome").val().length>2){$("#pesquisar_button").attr("disabled",false);}else{$("#pesquisar_button").attr("disabled",true);}}function selecionou_item_tabela(a){$.getJSON("/item_tabelas/busca_descricao",{id:$("#tratamento_item_tabela_id").selectedValues()[0]},function(b){resultado=b.split(";");$("#tratamento_descricao").val(resultado[0]);$("#tratamento_valor").val(resultado[1]);});}function coloca_data_de_hoje(c,a,b){$("#tratamento_data_3i").selectOptions(c+"");$("#tratamento_data_2i").selectOptions(a+"");$("#tratamento_data_1i").selectOptions(b+"");}function selecionou_forma(a){if($("#"+a).selectedOptions().text().toLowerCase()=="cheque"){$("#cheque").show();}else{$("#cheque").hide();}}function alterou_data_tratamento(){data=$("#datepicker").datepicker("getDate");if(data==null){$("#tratamento_data_3i").selectOptions("");$("#tratamento_data_2i").selectOptions("");$("#tratamento_data_1i").selectOptions("");}else{dia=data.getDate();mes=data.getMonth()+1;ano=data.getFullYear();$("#tratamento_data_3i").selectOptions(dia+"");$("#tratamento_data_2i").selectOptions(mes+"");$("#tratamento_data_1i").selectOptions(ano+"");}}function alterou_data_cadastro(){data=$("#datepicker").datepicker("getDate");if(data==null){$("#paciente_nascimento_3i").selectOptions("");$("#paciente_nascimento_2i").selectOptions("");$("#paciente_nascimento_1i").selectOptions("");}else{dia=data.getDate();mes=data.getMonth()+1;ano=data.getFullYear();$("#paciente_nascimento_3i").selectOptions(dia+"");$("#paciente_nascimento_2i").selectOptions(mes+"");$("#paciente_nascimento_1i").selectOptions(ano+"");}}function copia_valor(){$("#recebimento_cheque_attributes_valor").val($("#recebimento_valor").val());}function abre_uma_devolucao(){$("#devolvido_uma_vez").toggle("blind",{percent:0},500);}function abre_reapresentacao(){$("#reapresentado").toggle("blind",{percent:0},500);}function abre_segunda_devolucao(){$("#devolvido_duas_vezes").toggle("blind",{percent:0},500);}function enviar_administracao(){var d="";var a=$("input:checkbox");for(var b=0;b<a.length;b++){var c=a[b].id;if($("#"+c).is(":checked")){d+=c+",";}}$.getJSON("recebe_cheques",{cheques:d},function(e){$("form:last").trigger("submit");alert(e);});}function selecionar(){if($("#selecao").text()=="todos"){$("#selecao").text("nenhum");$("#tipo_pagamento_id").each(function(){$("#tipo_pagamento_id option").attr("selected","selected");});}else{$("#selecao").text("todos");$("#tipo_pagamento_id").each(function(){$("#tipo_pagamento_id option").removeAttr("selected");});}}function abre_cheque(a){window.open("/cheques/"+a,"abriu o cheque","height=260,width=480,status=no");}function abre_pagamento(a){window.open("/pagamentos/"+a,"abre o pagamento","height=600,width=600,status=no,resizable=yes,scrollbars=yes");}function pesquisa_disponiveis(){jQuery.ajax({url:"/cheques/busca_disponiveis",type:"GET",data:{valor:$("#pagamento_valor_pago_real").val()},success:function(a){$("#lista_de_cheques").replaceWith("<span id='lista_de_cheques'>"+a+"</span>");}});}function formata_valor(a){a.priceFormat({prefix:"",centsSeparator:",",thousandsSeparator:"."});}function seleciona_todas_as_formas_de_recebimento(){if($("#todas").is(":checked")){$("input[name*='forma']").attr("checked",true);}else{$("input[name*='forma']").attr("checked",false);}}jQuery(function(){$.loading({onAjax:true,text:"Carregando ...",align:"center",mask:true});});function confirma_recebimento_de_cheque(){var d="";var a=$("input:checkbox");for(var b=0;b<a.length;b++){var c=a[b].id;if($("#"+c).is(":checked")){d+=c+",";}}$.getJSON("registra_recebimento_de_cheques",{cheques:d},function(e){alert(e);});}function pagar(c,f,b){anterior=$("#valor").text();valor_total=parseFloat(anterior);if($("#pagar_"+f).is(":checked")==true){valor_total=valor_total+c;}else{valor_total=valor_total-c;}$("#valor").text(valor_total);var a=$(":checkbox[name|='pagar']:checked");var d="";for(f=0;f<a.size();f++){d=d+","+a[f].value;}if(d.length>1){d=d.substring(1);}var e="<span id='link_pagamento'><a href='/pagamentos/new?valor="+valor_total+"&trabalho_protetico_id="+d+"&protetico_id="+b+"'>efetua pagamento</a></span>";$("#link_pagamento").replaceWith(e);}function pagar_dentista(b,a,d){anterior=$("#valor").text();valor_total=parseFloat(anterior);if($("#pagar_dentista_"+a).is(":checked")==true){valor_total=valor_total+b;}else{valor_total=valor_total-b;}$("#valor").text(valor_total);var c="<span id='link_pagamento'><a href='/pagamentos/new?valor="+valor_total+"&dentista_id="+d+"'>efetua pagamento</a></span>";$("#link_pagamento").replaceWith(c);}function pagamento_dentista(b){var a=$("#fragment-3 input:checkbox");url="pagamento?inicio='"+$("#datepicker3").val()+"'&fim='"+$("#datepicker4").val()+"'&dentista_id="+b;$.getJSON(url,function(c){$("#lista_pagamento").replaceWith(c);});}function registra_confirmacao_de_entrada(){entradas=$("input:checked");id_str="";$.each(entradas,function(a,b){aux=((b.id).split("_"));id_str+=aux[1]+",";});jQuery.ajax({url:"/entradas/registra_confirmacao_de_entrada",type:"POST",data:{data:id_str},success:function(a){$("input:submit").click();}});}function busca_proteticos_da_clinica(){$.ajax({url:"/proteticos/busca_proteticos_da_clinica",type:"GET",data:{clinica_id:$("#clinica").val()},success:function(a){$("#protetico").html("");for(var b=0;b<a.length;b++){$("#protetico").append(new Option(a[b],a[b]));}}});}function pagamento_protetico(){var c=$("input:checked");id_str="";valor_a_pagar=0;$.each(c,function(d,e){aux=((e.id).split("_"));id_str+=aux[2]+",";valor_a_pagar+=parseFloat($("#valor_"+aux[2]).html());});var b=$("#protetico_id").val();var a="http://"+window.location.host+"/pagamentos/registra_pagamento_a_protetico?ids='"+id_str+"'&valores='"+valor_a_pagar+"' &protetico_id="+b;alert(a);window.location=a;}function busca_saldo(){$("#data").replaceWith("<span id=data></span>");$("#saldo_em_dinheiro").val("");$("#saldo_em_cheque").val("");$.ajax({url:"/busca_saldo",type:"GET",data:{clinica:$("#clinica").val()},success:function(a){var b=a.split(";");$("#data").replaceWith(b[0]);$("#saldo_em_dinheiro").val(b[1]);$("#saldo_em_cheque").val(b[2]);}});}function limpa_nome(){$("#nome").val("");}function limpa_codigo(){$("#codigo").val("");}function selecionou_cheque(a){var e=0;var b=$("#lista_de_cheques :checked");var g="";for(var d=0;d<b.length;d++){id_cheque=(b[d].id).split("_")[1];g+=id_cheque+",";var c=$("#valor_"+id_cheque).text();c=c.replace(".","");c=parseFloat(c.replace(",","."));e+=c;}$("#cheques_ids").val(g);var f=$("#pagamento_valor_pago").val();if(f<e){alert("A soma dos valores dos cheques selecionados Ã© maior que o valor do pagamento.");}$("#pagamento_valor_restante").val(parseInt((f-e)*100));formata_valor($("#pagamento_valor_restante"));}function producao(){var c=$("#fragment-2 input:checkbox");var a="";for(var b=0;b<c.length;b++){if($("#"+c[b].id).is(":checked")){a+=$("#"+c[b].id).val()+",";}}url="producao?datepicker='"+$("#datepicker").val()+"'&datepicker2='"+$("#datepicker2").val()+"'&clinicas="+a;$.getJSON(url,function(d){$("#lista").replaceWith(d);});}function cheque(a){if(a==1){$("#cheque_classident").show();$("#pagamento_conta_bancaria_id").focus();$("#pagamento_valor_cheque").val($("#pagamento_valor_restante").val());}else{$("#cheque_classident").hide();$("#pagamento_numero_do_cheque").val("");$("#pagamento_valor_cheque").val("");}}function escolheu_protetico(){$("#trabalho_protetico_tabela_protetico_id").hide();$.getJSON("/proteticos/busca_tabela",{protetico_id:$("#trabalho_protetico_protetico_id").val()},function(c){$("#trabalho_protetico_tabela_protetico_id").html("");saida="";for(var b=0;b<c.length;b++){if(b==0){var a=c[0][1];$.getJSON("/tabela_proteticos/busca_valor",{id:a},function(d){$("#trabalho_protetico_valor").val(d);});}$("#trabalho_protetico_tabela_protetico_id").append(new Option(c[b][0]+" ",c[b][1]));}});$("#trabalho_protetico_tabela_protetico_id").show();}function escolheu_item_da_tabela(){$.getJSON("/tabela_proteticos/busca_valor",{id:$("#trabalho_protetico_tabela_protetico_id").val()},function(a){$("#trabalho_protetico_valor").val(a);});}function devolve_trabalho(f){$.get("/registra_devolucao_de_trabalho?id="+f);var e=new Date();var a=e.getDate();var c=e.getMonth();c++;var b=e.getFullYear();$("#data_"+f).replaceWith(a+"/"+c+"/"+b);}function registra_devolucao(f){$.get("/registra_devolucao_de_trabalho?id="+f);var e=new Date();var a=e.getDate();var c=e.getMonth();c++;var b=e.getFullYear();$("#data_devolucao_"+f).replaceWith(a+"/"+c+"/"+b);}function selecionou_estado(){$(":checkbox").attr("checked",false);}function busca_pacientes_que_iniciam_com(a){$("#linha_"+a).show();$.getJSON("/pacientes/nomes_que_iniciam_com?nome="+$("#"+a).val()+"&div="+a,function(b){$("#nomes_"+a).replaceWith('<div id="nomes_'+a+'"  class="lista">'+b+"</div>");});}function escolheu_nome_da_lista(a,c,b){$("#"+c).val(a);$("#id_"+c).val(b);$("#linha_"+c).hide();}function selecionou_face(){$("#tratamento_estado_nenhum").attr("checked",true);}function todas_as_faces(){selecionou_face();$(":checkbox").attr("checked",$("#todas").is(":checked"));}function selecionou_tratamento(){var a=$(":checked");var b=0;for(i=0;i<a.length;i++){b=b+parseFloat(a[i].value);}$("#orcamento_valor").val(b);}function calcula_valor_orcamento(){total=parseFloat($("#orcamento_valor").val());desconto=parseFloat($("#orcamento_desconto").val());$("#orcamento_valor_com_desconto").val(total-(total*desconto/100));calcula_valor_da_parcela();}function calcula_valor_da_parcela(){valor_com_desconto=$("#orcamento_valor_com_desconto").val().replace(",",".");valor=parseFloat(valor_com_desconto);numero=$("#orcamento_numero_de_parcelas").val();$("#orcamento_valor_da_parcela").val(parseInt((valor/numero)*100));formata_valor($("#orcamento_valor_da_parcela"));$.getJSON("monta_tabela_de_parcelas?numero_de_parcelas="+numero+"&valor_da_parcela="+valor+"&data_primeira_parcela="+$("#orcamento_vencimento_primeira_parcela").val(),function(a){$("#parcelas").replaceWith(a);});}function definir_valor(){if($("#acima_de_um_valor").is(":checked")){$("#valor").focus();}else{$("#valor").val("");}}function orcamento_dentista(){var c=$("#fragment-4 input:checkbox");var a="";for(var b=0;b<c.length;b++){if($("#"+c[b].id).is(":checked")){a+=$("#"+c[b].id).val()+",";}}url="orcamentos?inicio='"+$("#datepicker5").val()+"'&fim='"+$("#datepicker6").val()+"'&clinicas="+a;$.getJSON(url,function(d){$("#lista_orcamento").replaceWith(d);});}function finalizar_tratamento(a){$.ajax({url:"/tratamentos/"+a+"/finalizar_procedimento",success:function(){window.location.reload();}});}function busca_id(a){$.ajax({url:"/pacientes/busca_id_do_paciente",type:"GET",data:{nome:$("#paciente_"+a).val()},success:function(b){$("#paciente_id_"+a).val(b);}});}